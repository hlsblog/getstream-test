# Stream Feeds Web界面使用指南

## 🌟 功能概述

这个Web界面提供了一个完整的用户友好的界面来管理Stream Feeds的用户feed和foryou推荐feed。你可以通过这个界面轻松地设置用户ID、切换不同的feed类型、发布内容以及查看feed列表。

## 🚀 快速开始

### 1. 启动服务器
```bash
npm run web
# 或者
npm run server
```

### 2. 访问界面
打开浏览器访问: http://localhost:3000

### 3. 配置环境
确保 `.env` 文件中配置了正确的Stream API信息：
```
STREAM_API_KEY=your-api-key
STREAM_API_SECRET=your-api-secret
STREAM_APP_ID=your-app-id
```

## 📱 界面功能详解

### 1. 用户设置区域
- **用户ID输入框**: 输入要管理的用户ID
- **设置用户按钮**: 连接到指定用户并验证权限
- **当前用户显示**: 显示已连接的用户信息

### 2. Feed切换标签
- **用户Feed标签**: 显示 `user:{userId}` 的个人动态
- **推荐Feed标签**: 显示 `foryou:{userId}` 的推荐内容
- **刷新按钮**: 手动刷新当前显示的feed内容

### 3. 内容发布区域
- **内容输入框**: 输入要发布的文本内容
- **发布目标选择**:
  - `仅用户Feed`: 只发布到用户的个人feed
  - `仅ForYou推荐`: 只发布到用户的推荐feed
  - `同时发布到两者`: 同时发布到用户feed和推荐feed
- **发布按钮**: 执行内容发布
- **清空按钮**: 清空输入表单

### 4. Feed内容显示区域
- **Feed标题**: 显示当前查看的feed类型
- **内容计数**: 显示当前feed中的内容数量
- **内容列表**: 以时间倒序显示feed中的所有内容
- **内容详情**: 每条内容显示文本、类型和发布时间

## 🎯 使用场景

### 场景1: 个人动态管理
1. 设置用户ID (例如: `user123`)
2. 切换到"用户Feed"标签
3. 在发布区域选择"仅用户Feed"
4. 输入个人动态内容并发布
5. 查看用户feed中的新内容

### 场景2: 推荐内容管理
1. 确保已设置用户ID
2. 切换到"推荐Feed"标签
3. 在发布区域选择"仅ForYou推荐"
4. 输入推荐内容并发布
5. 查看foryou feed中的推荐内容

### 场景3: 全局推送
1. 设置目标用户ID
2. 在发布区域选择"同时发布到两者"
3. 输入全局推送内容
4. 发布后内容会同时出现在用户feed和推荐feed中

## 🔧 API接口说明

### 用户管理
- `GET /api/user/:userId/info` - 获取用户信息并验证连接

### Feed内容获取
- `GET /api/feeds/user/:userId` - 获取用户feed内容
- `GET /api/feeds/foryou/:userId` - 获取foryou推荐feed内容

### 内容发布
- `POST /api/feeds/user/:userId/post` - 发布到用户feed
- `POST /api/feeds/foryou/:userId/post` - 发布到foryou feed
- `POST /api/feeds/both/:userId/post` - 同时发布到两个feed

### 请求参数
```javascript
// 发布内容请求体
{
  "text": "要发布的内容",
  "type": "post" // 可选，内容类型
}
```

### 响应格式
```javascript
// 成功响应
{
  "success": true,
  "data": {
    "feedType": "user",
    "userId": "user123",
    "activities": [...],
    "total": 5
  }
}

// 错误响应
{
  "success": false,
  "error": "错误描述",
  "message": "详细错误信息"
}
```

## 🎨 界面特性

### 响应式设计
- 支持桌面端和移动端访问
- 自适应布局，在不同屏幕尺寸下都有良好体验

### 用户体验优化
- 实时状态反馈（加载中、成功、错误）
- 自动消息清除（3秒后自动隐藏状态消息）
- 优化的超时设置（20秒请求超时，适应不同网络环境）
- 智能错误提示（区分超时错误和其他网络错误）
- 快捷键支持：
  - `Enter`: 在用户ID输入框中快速设置用户
  - `Ctrl+Enter`: 在内容输入框中快速发布

### 视觉设计
- 现代化渐变背景
- 卡片式布局设计
- 清晰的视觉层次
- 友好的图标和颜色搭配

## 🔍 故障排除

### 常见问题

#### 1. 用户连接失败
**现象**: 设置用户ID时提示连接失败
**解决方案**: 
- 检查 `.env` 文件中的API配置
- 确保Stream API Secret正确
- 检查网络连接

#### 2. 用户连接错误
**现象**: 提示 "Can't connect a new user, call 'disconnectUser' first"
**解决方案**:
- 系统已自动处理用户切换时的连接管理
- 如果仍有问题，刷新页面重试
- 确保每次只连接一个用户

#### 3. 内容加载失败
**现象**: 切换feed时显示加载失败
**解决方案**:
- 确保用户已正确连接
- 检查API权限设置
- 刷新页面重试

#### 4. 发布内容失败
**现象**: 点击发布按钮后提示发布失败
**解决方案**:
- 确保内容不为空
- 检查用户连接状态
- 验证API配置

### 调试技巧

#### 1. 查看浏览器控制台
按 `F12` 打开开发者工具，查看Console标签中的错误信息

#### 2. 查看网络请求
在开发者工具的Network标签中查看API请求的详细信息

#### 3. 查看服务器日志
在运行 `npm run web` 的终端中查看服务器端的日志输出

## 📈 扩展功能建议

### 1. 实时更新
- 集成WebSocket实现实时feed更新
- 自动刷新机制

### 2. 内容管理
- 内容编辑功能
- 内容删除功能
- 内容搜索和过滤

### 3. 用户管理
- 多用户切换
- 用户偏好设置
- 用户权限管理

### 4. 数据分析
- Feed活跃度统计
- 内容互动分析
- 用户行为追踪

## 🔐 安全注意事项

1. **API Secret保护**: 确保API Secret只在服务器端使用，不要暴露给客户端
2. **用户验证**: 在生产环境中添加适当的用户身份验证
3. **内容审核**: 对用户发布的内容进行适当的审核和过滤
4. **访问控制**: 限制API访问频率，防止滥用

## 📞 技术支持

如果遇到问题或需要帮助，请：
1. 查看本文档的故障排除部分
2. 检查项目的README.md文件
3. 查看Stream Feeds官方文档
4. 在项目仓库中提交Issue

---

**享受使用Stream Feeds Web界面！** 🎉